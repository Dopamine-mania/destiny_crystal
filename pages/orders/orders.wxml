<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header">
    <view class="header-top">
      <view class="back-btn" bindtap="onBack">
        <text class="back-icon">â†</text>
      </view>
      <view class="title">
        <text class="icon">ğŸ“¦</text>
        <text class="title-text">è®¢å•ç®¡ç†</text>
      </view>
      <view class="placeholder"></view>
    </view>
  </view>

  <!-- è®¢å•çŠ¶æ€æ ‡ç­¾ -->
  <view class="tab-bar">
    <view 
      wx:for="{{tabList}}" 
      wx:key="key" 
      class="tab-item {{currentTab === item.key ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="{{item.key}}"
    >
      <text class="tab-text">{{item.name}}</text>
      <text wx:if="{{item.count > 0}}" class="tab-count">{{item.count}}</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading">
    <text class="loading-icon">â³</text>
    <text class="loading-text">åŠ è½½è®¢å•åˆ—è¡¨ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:elif="{{isEmpty}}" class="empty-state">
    <text class="empty-icon">ğŸ“¦</text>
    <text class="empty-title">æš‚æ— è®¢å•</text>
    <text class="empty-desc">æ‚¨è¿˜æ²¡æœ‰ä»»ä½•è®¢å•è®°å½•</text>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view wx:else class="orders-list">
    <view 
      wx:for="{{getCurrentOrders()}}" 
      wx:key="id" 
      class="order-card {{item.status}}"
    >
      <!-- è®¢å•å¤´éƒ¨ -->
      <view class="order-header">
        <view class="order-info">
          <text class="order-no">è®¢å•å·ï¼š{{item.orderNo}}</text>
          <text class="create-time">{{item.createTime}}</text>
        </view>
        <view class="order-status">
          <text class="status-text">{{item.statusText}}</text>
        </view>
      </view>

      <!-- å•†å“åˆ—è¡¨ -->
      <view class="order-items">
        <view wx:for="{{item.items}}" wx:key="index" class="order-item">
          <view class="item-image">
            <text class="item-emoji">ğŸ’</text>
            <view class="element-tag element-{{item.element}}">{{item.element}}</view>
          </view>
          <view class="item-info">
            <view class="item-name">{{item.name}}</view>
            <view class="item-price">Â¥{{item.price}} Ã— {{item.quantity}}</view>
          </view>
        </view>
      </view>

      <!-- è®¢å•é‡‘é¢ -->
      <view class="order-amount">
        <text class="amount-label">è®¢å•æ€»é¢ï¼š</text>
        <text class="amount-value">Â¥{{item.totalAmount}}</text>
      </view>

      <!-- æ”¶è´§åœ°å€ -->
      <view wx:if="{{item.address}}" class="order-address">
        <text class="address-label">æ”¶è´§åœ°å€ï¼š</text>
        <text class="address-text">{{item.address.name}} {{item.address.phone}} {{item.address.detail}}</text>
      </view>

      <!-- ç‰©æµä¿¡æ¯ -->
      <view wx:if="{{item.trackingNo}}" class="tracking-info">
        <text class="tracking-label">å¿«é€’å•å·ï¼š</text>
        <text class="tracking-no">{{item.trackingNo}}</text>
      </view>

      <!-- è®¢å•æ“ä½œ -->
      <view class="order-actions">
        <!-- å¾…ä»˜æ¬¾çŠ¶æ€ -->
        <view wx:if="{{item.status === 'pending'}}" class="action-group">
          <button 
            class="action-btn secondary"
            bindtap="onOrderAction"
            data-action="cancel"
            data-order-id="{{item.id}}"
          >
            å–æ¶ˆè®¢å•
          </button>
          <button 
            class="action-btn primary"
            bindtap="onOrderAction"
            data-action="pay"
            data-order-id="{{item.id}}"
          >
            ç«‹å³æ”¯ä»˜
          </button>
        </view>

        <!-- å¾…å‘è´§çŠ¶æ€ -->
        <view wx:elif="{{item.status === 'paid'}}" class="action-group">
          <button 
            class="action-btn secondary"
            bindtap="onOrderAction"
            data-action="contact"
            data-order-id="{{item.id}}"
          >
            è”ç³»å®¢æœ
          </button>
        </view>

        <!-- å¾…æ”¶è´§çŠ¶æ€ -->
        <view wx:elif="{{item.status === 'shipped'}}" class="action-group">
          <button 
            class="action-btn secondary"
            bindtap="onOrderAction"
            data-action="logistics"
            data-order-id="{{item.id}}"
          >
            æŸ¥çœ‹ç‰©æµ
          </button>
          <button 
            class="action-btn primary"
            bindtap="onOrderAction"
            data-action="confirm"
            data-order-id="{{item.id}}"
          >
            ç¡®è®¤æ”¶è´§
          </button>
        </view>

        <!-- å·²å®ŒæˆçŠ¶æ€ -->
        <view wx:elif="{{item.status === 'received'}}" class="action-group">
          <button 
            class="action-btn secondary"
            bindtap="onOrderAction"
            data-action="delete"
            data-order-id="{{item.id}}"
          >
            åˆ é™¤è®¢å•
          </button>
          <button 
            class="action-btn secondary"
            bindtap="onOrderAction"
            data-action="review"
            data-order-id="{{item.id}}"
          >
            è¯„ä»·
          </button>
          <button 
            class="action-btn primary"
            bindtap="onOrderAction"
            data-action="contact"
            data-order-id="{{item.id}}"
          >
            è”ç³»å®¢æœ
          </button>
        </view>

        <!-- å·²å–æ¶ˆçŠ¶æ€ -->
        <view wx:elif="{{item.status === 'cancelled'}}" class="action-group">
          <button 
            class="action-btn secondary"
            bindtap="onOrderAction"
            data-action="delete"
            data-order-id="{{item.id}}"
          >
            åˆ é™¤è®¢å•
          </button>
        </view>
      </view>
    </view>
  </view>
</view>