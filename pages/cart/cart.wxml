<view class="container">
  <view class="header">
    <view class="title">
      <text class="icon">ğŸ›’</text>
      <text class="title-text">è´­ç‰©è½¦</text>
    </view>
  </view>

  <view wx:if="{{cartItems.length === 0}}" class="empty-cart">
    <text class="empty-icon">ğŸ›’</text>
    <text class="empty-text">è´­ç‰©è½¦æ˜¯ç©ºçš„</text>
    <button class="back-btn" bindtap="onBack">è¿”å›</button>
  </view>

  <view wx:else class="cart-content">
    <!-- å…¨é€‰åŒºåŸŸ -->
    <view class="select-all-section">
      <view class="select-all" bindtap="onSelectAll">
        <text class="checkbox {{selectAll ? 'checked' : ''}}">{{selectAll ? 'âœ“' : 'â—‹'}}</text>
        <text class="select-text">å…¨é€‰</text>
      </view>
      <text class="item-count">å…±{{cartItems.length}}ä»¶å•†å“</text>
    </view>

    <view class="cart-items">
      <view wx:for="{{cartItems}}" wx:key="id" class="cart-item">
        <!-- å•†å“é€‰æ‹©æ¡† -->
        <view class="item-select" bindtap="onItemSelect" data-index="{{index}}">
          <text class="checkbox {{selectedItems[index] ? 'checked' : ''}}">{{selectedItems[index] ? 'âœ“' : 'â—‹'}}</text>
        </view>
        
        <!-- å•†å“å›¾ç‰‡ -->
        <view class="item-image">
          <text class="item-emoji">ğŸ’</text>
          <view wx:if="{{item.element}}" class="item-element element-{{item.element}}">{{item.element}}</view>
        </view>
        
        <!-- å•†å“ä¿¡æ¯ -->
        <view class="item-info">
          <view class="item-name">{{item.name}}</view>
          <view wx:if="{{item.element}}" class="item-desc">{{item.element}}å…ƒç´ æ°´æ™¶</view>
          <view class="item-price">Â¥{{item.price}}</view>
        </view>
        
        <!-- æ“ä½œåŒºåŸŸ -->
        <view class="item-actions">
          <view class="quantity-controls">
            <button 
              class="qty-btn" 
              bindtap="onQuantityChange"
              data-index="{{index}}"
              data-type="decrease"
            >-</button>
            <text class="quantity">{{item.quantity}}</text>
            <button 
              class="qty-btn"
              bindtap="onQuantityChange" 
              data-index="{{index}}"
              data-type="increase"
            >+</button>
          </view>
          <button 
            class="remove-btn"
            bindtap="onRemoveItem"
            data-index="{{index}}"
          >ç§»é™¤</button>
        </view>
      </view>
    </view>

    <!-- åè®®ç¡®è®¤ -->
    <view class="agreement-section">
      <view class="agreement-check" bindtap="onAgreeAgreement">
        <text class="checkbox {{agreeAgreement ? 'checked' : ''}}">{{agreeAgreement ? 'âœ“' : 'â—‹'}}</text>
        <text class="agreement-text">æˆ‘å·²é˜…è¯»å¹¶åŒæ„</text>
        <text class="agreement-link" bindtap="onViewAgreement" catchtap="true">ã€Šè´­ä¹°åè®®ã€‹</text>
      </view>
    </view>

    <!-- ç»“ç®—åŒºåŸŸ -->
    <view class="total-section">
      <view class="total-info">
        <view class="selected-count">
          <text class="count-text">å·²é€‰({{selectedCount}})</text>
        </view>
        <view class="total-amount">
          <text class="total-label">åˆè®¡:</text>
          <text class="total-value">Â¥{{totalAmount}}</text>
        </view>
      </view>
      <view class="checkout-actions">
        <button class="action-btn secondary" bindtap="onBack">ç»§ç»­è´­ç‰©</button>
        <button 
          class="action-btn primary {{canCheckout ? '' : 'disabled'}}" 
          bindtap="onCheckout"
        >
          ç«‹å³ç»“ç®—
        </button>
      </view>
    </view>
  </view>
</view>
